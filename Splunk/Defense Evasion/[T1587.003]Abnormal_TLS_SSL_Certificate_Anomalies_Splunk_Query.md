
# [T1553.004] Subvert Trust Controls: Install Root Certificate

### Mitre Tactic:

*Defense Evasion*

#### Description:

Detects use of **self-signed, fake, or suspicious SSL/TLS certificates** often leveraged by adversaries for man-in-the-middle (MITM) attacks, exfiltration, or command-and-control traffic masquerading as legitimate encrypted sessions. This detection leverages Zeek SSL logs to identify connections where the certificate issuer or subject looks suspicious (e.g., *localhost*, *example*, *fake*, or *test* certificates).

```bash
index=zeek sourcetype="zeek:ssl" (validation_status="self signed certificate" OR issuer="*CN=localhost*" OR issuer="*CN=example*" OR issuer="*CN=fake*" OR subject="*test*")
| stats count by subject, issuer, validation_status, id.orig_h, id.resp_h
| table subject, issuer, validation_status, id.orig_h, id.resp_h, count
```
