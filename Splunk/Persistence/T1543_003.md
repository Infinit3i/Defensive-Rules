
## [T1543.003] Create or Modify System Process: Windows Service

### Mitre Tactic:

*Persistence, Privilege Escalation*

#### Description:

Detects the creation of new services with short, suspicious 4-character names. Adversaries often install malicious services with unusual naming conventions to blend in or evade detection. Uses Windows Event ID 7045 from the System event log to identify these anomalies.

```bash
index="aa15cbf9" source="XmlWinEventLog:System" EventCode=7045
| regex ServiceName="^[A-Za-z]{4}$"
| table _time, Computer, ServiceName, ImagePath, AccountName
```

---

## [T1543.003] Create or Modify System Process: Windows Service

### Mitre Tactic:

*Persistence, Privilege Escalation*

#### Description:

Detects suspicious services that execute binaries with 8-character random-looking names. Malware frequently uses randomly generated filenames to evade signature-based detection. This rule looks for `.exe` binaries with such patterns in the service installation logs (Event ID 7045).

```bash
index="aa15cbf9" source="XmlWinEventLog:System" EventCode=7045
| regex ImagePath=".*\\\\[A-Za-z]{8}\\.exe"
| table _time, Computer, ServiceName, ImagePath, AccountName
```
