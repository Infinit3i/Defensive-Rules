# [T1059.001] PowerShell_Encoded_Commands_Splunk_Query

### Mitre Tactic:  
*Execution*

---

#### Description:  
Detects execution of encoded or obfuscated PowerShell commands (e.g., `-EncodedCommand`, `-enc`, `IEX`, `Invoke-Expression`) by correlating Windows Security Event ID 4688 with Sysmon Event ID 1. Highlights instances where adversaries bypass script block logging or hide payloads in Base64.

---

```bash
index=wineventlog (EventCode=4688 OR EventCode=1) ("powershell.exe" AND ("-EncodedCommand" OR "-enc" OR "IEX" OR "Invoke-Expression"))
| table _time, host, user, CommandLine, Image, ParentProcessName
| sort _time desc
```
