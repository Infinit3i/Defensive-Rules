**Description**:  
Detects potential DNS tunneling by identifying large volumes of DNS queries with suspicious patterns like unusually long subdomains, frequent lookups, or encoded strings. Based on Sysmon Event ID 22 (DNS Query).

```spl
index=sysmon EventCode=22
| where QueryName LIKE "%.%" AND (strlen(QueryName) > 50 OR QueryName LIKE "%.%.%.%.%")
| stats count by QueryName, Image, User, ComputerName
| where count > 50
| sort -count
```