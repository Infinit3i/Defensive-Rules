
# \[T1071.004] Application Layer Protocol: DNS

### Mitre Tactic:

*Command and Control*

#### Description:

Detects potential **DNS tunneling activity** by looking for abnormally long TXT or NULL record queries. Adversaries often abuse these record types to exfiltrate data or establish covert command-and-control channels over DNS. This rule inspects Zeek DNS logs, measures query length, and flags queries longer than 50 characters.

```bash
index=zeek sourcetype="zeek:dns" (qtype_name="TXT" OR qtype_name="NULL")
| eval query_length = len(query)
| where query_length > 50
| stats count by query, qtype_name, id_orig_h, id_resp_h
| sort - count
| table query, qtype_name, id_orig_h, id_resp_h, count
```
