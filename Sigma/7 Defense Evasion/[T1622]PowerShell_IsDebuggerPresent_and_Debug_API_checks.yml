title: PowerShell IsDebuggerPresent or Debug API checks in ScriptBlock
id: d1a2b3c4-5d6e-7f80-1234-abcdef012345
status: experimental
description: Detect PowerShell scriptblocks that reference common anti-debugging APIs or strings such as IsDebuggerPresent, CheckRemoteDebuggerPresent, OutputDebugString, or CheckRemoteDebuggerPresent. Attackers may call these to detect attached debuggers.
references:
  - https://attack.mitre.org/techniques/T1622/
author: Matthew Iverson
date: 2025-10-19
tags:
  - attack.t1622
  - tactic.defense-evasion
  - platform:windows
  - technique:T1622
  - mitre_version:16.1
logsource:
  product: windows
  service: powershell
detection:
  selection_scriptblock:
    EventID: 4104
    ScriptBlockText|contains:
      - "IsDebuggerPresent"
      - "CheckRemoteDebuggerPresent"
      - "OutputDebugString"
      - "NtQueryInformationProcess"
      - "IsProcessorFeaturePresent"
  condition: selection_scriptblock
falsepositives:
  - Developer/debug scripts, legitimate diagnostics or monitoring scripts that probe runtime.
level: high
