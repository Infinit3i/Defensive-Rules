title: Stepped timer loops or exponential backoff used as long delay
id: a0f3b6c7-1d2e-4f5a-9b8c-0d1e2f3a4b5c
status: experimental
description: Detect patterns indicative of scripted stepped waits or exponential backoff loops (incremental sleep/ping loops) used to extend execution time beyond sandbox limits.
author: Matthew Iverson
date: 2025-10-19
references:
  - https://attack.mitre.org/techniques/T1497/003/
tags:
  - attack.t1497.003
  - tactic.defense-evasion
  - platform:windows
  - technique:T1497.003
  - mitre_version:16.1
logsource:
  product: windows
  service: powershell
detection:
  selection_backoff_loop:
    EventID: 4104
    ScriptBlockText|contains|all:
      - "for("
      - "Start-Sleep"
      - "$i++"
  selection_incremental_sleep:
    EventID: 4104
    ScriptBlockText|contains:
      - "Start-Sleep ($i)"
      - "Start-Sleep -Seconds $i"
      - "Start-Sleep -Seconds ($i *"
  condition: selection_backoff_loop or selection_incremental_sleep
falsepositives:
  - Legitimate retry/backoff implementations in automation and resilient scripts.
level: medium
