title: Suspicious Command Shell Activity (Encoded or Obfuscated Commands)
id: 82a7dfe1-59f9-4b2a-bb02-7a2a63f0d002
status: experimental
description: Detects suspicious use of cmd.exe executing encoded or obfuscated commands often used by attackers to evade detection.
references:
  - https://attack.mitre.org/techniques/T1059/003/
author: Matthew Iverson
date: 2025-10-20
tags:
  - attack.execution
  - attack.t1059.003
  - windows
  - cmd
  - malware
  - apt
logsource:
  product: windows
  service: sysmon
  category: process_creation
detection:
  selection:
    Image|endswith: '\cmd.exe'
    CommandLine|contains:
      - '/c'
      - '&&'
      - '||'
      - '^'
      - '%'
      - 'set '
      - 'for '
      - 'call '
      - 'powershell'
      - 'certutil'
      - 'bitsadmin'
      - 'whoami'
  condition: selection
falsepositives:
  - Administrative scripts or automation tasks
level: medium
tactic: Execution
