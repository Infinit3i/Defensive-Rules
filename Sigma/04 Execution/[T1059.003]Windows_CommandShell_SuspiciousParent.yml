title: CMD Launched From Suspicious Parent Process
id: 1dcbf2a9-c7a1-4121-b4b9-3bce6e0c7e2b
status: experimental
description: Detects when cmd.exe is launched from a suspicious or uncommon parent process (e.g., Office apps, browsers, or script hosts), which can indicate malicious code execution.
references:
  - https://attack.mitre.org/techniques/T1059/003/
author: Matthew Iverson
date: 2025-10-20
tags:
  - attack.execution
  - attack.t1059.003
  - cmd
  - apt
  - malware
logsource:
  product: windows
  service: sysmon
  category: process_creation
detection:
  selection:
    Image|endswith: '\cmd.exe'
    ParentImage|endswith:
      - '\winword.exe'
      - '\excel.exe'
      - '\outlook.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\mshta.exe'
      - '\iexplore.exe'
      - '\chrome.exe'
      - '\firefox.exe'
  condition: selection
falsepositives:
  - Legitimate scripts or macros
level: high
tactic: Execution
