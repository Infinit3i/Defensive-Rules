title: PowerShell Download and Execution from Remote Source
id: 9e2c3f5a-8f88-4b77-bd29-2222bbbapsh2
status: experimental
description: Detects PowerShell commands that download and execute scripts or payloads directly from remote URLs or network shares.
author: Matthew Iverson
date: 2025-10-19
references:
  - https://attack.mitre.org/techniques/T1086/
logsource:
  product: windows
  service: sysmon
  category: process_creation
detection:
  selection_image:
    Image|endswith: '\powershell.exe'
  selection_remote:
    CommandLine|contains:
      - 'Invoke-WebRequest'
      - 'Start-BitsTransfer'
      - 'DownloadString'
      - 'DownloadFile'
      - 'Net.WebClient'
      - 'IEX'
  selection_protocol:
    CommandLine|contains:
      - 'http://'
      - 'https://'
      - '\\\\'
  condition: selection_image and selection_remote and selection_protocol
fields:
  - CommandLine
  - ParentCommandLine
  - Image
  - User
  - ParentImage
falsepositives:
  - Legitimate update scripts or cloud-based administration tasks
level: critical
tags:
  - attack.T1086
  - execution
  - windows
  - sysmon
  - powershell
  - cloud
  - CobaltStrike
  - FIN7
