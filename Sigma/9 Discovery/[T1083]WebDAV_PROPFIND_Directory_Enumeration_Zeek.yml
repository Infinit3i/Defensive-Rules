title: WebDAV_PROPFIND_Directory_Enumeration_Zeek
id: 3c4d5e6f-7081-92a0-b1c2-3d4e5f6a7b8c
status: experimental
description: Detect WebDAV/HTTP directory enumeration via PROPFIND requests and directory traversal-like URIs (Depth header, PROPFIND method) observed in Zeek/HTTP logs indicating remote directory discovery.
references:
  - https://attack.mitre.org/techniques/T1083/
author: Matthew Iverson
date: 2025-10-19
tags:
  - attack.t1083
  - tactic.discovery
  - platform:network
  - technique:T1083
  - mitre_version:16.1
logsource:
  product: network
  service: zeek
detection:
  selection_propfind:
    zeek.http.method|contains:
      - "PROPFIND"
  selection_depth_header:
    zeek.http.headers|contains:
      - "Depth: 1"
      - "Depth: infinity"
  selection_path_pattern:
    zeek.http.uri|matches:
      - "^/.*(/|%2F).*"   # URIs containing directory-like patterns (basic)
  condition: selection_propfind and selection_depth_header
falsepositives:
  - Legitimate WebDAV clients and sync tools (SharePoint, Nextcloud, DAV mounts). Consider allowing known sync servers.
level: medium
fields:
  - zeek.http.method
  - zeek.http.uri
  - zeek.http.headers
